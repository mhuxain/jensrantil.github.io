<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" type="text/css" href="http://jensrantil.github.io/theme/css/style.css">
	<!--<link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">-->
	<!--<script src="/theme/js/less.js" type="text/javascript"></script>-->
	<link rel="stylesheet" type="text/css" href="http://jensrantil.github.io/theme/css/pygments.css">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>

	<link href="http://jensrantil.github.io/" type="application/atom+xml" rel="alternate" title="Jens Rantil's Hideout ATOM Feed" />
	
	
			<title>Jens Rantil's Hideout</title>
		<meta charset="utf-8" />
	</head>
<body>
	<section id="sidebar">
		<figure id="user_logo">
            <a href="http://jensrantil.github.io"><div class="logo">&nbsp;</div></a>
		</figure>

		<div class="user_meta">
            <h1 id="user"><a href="http://jensrantil.github.io" class="">Jens Rantil</a></h1>
			<h2></h2>
						<p class="bio">Swedish/English, fullstack software engineer (<a href="http://www.telavox.se" target="_blank">@Telavox</a>), engineering mathematics, traveller, nerd, juggler, guitarist, african drum player. Inspired Swede.</p>
						<ul>
																			<li><a href="http://jensrantil.github.io/pages/about-jens.html">About Jens</a></li>
																		<li><a href="http://www.twitter.com/JensRantil">Twitter</a></li>
									<li><a href="http://www.github.com/JensRantil">Github</a></li>
							</ul>
		</div>
		<footer>
			<address>
				Powered by <a href="http://pelican.notmyidea.org/">Pelican</a>,
		                theme by <a href="https://github.com/wting/pelican-svbtle">wting</a>.
			</address>
		</footer>
	</section>

	<section id="posts">
			<header>
		<h1>Jens Rantil's blog</h1>
		<h3>Posted Mon 13 May 2013</h3>
	</header>
	<article>
		<h1 id="title">
			<a href="http://jensrantil.github.io/writing-a-server-in-python-using-zeromq.html" rel="bookmark"
				title="Permalink to Writing a server in Python using ZeroMQ">Writing a server in Python using ZeroMQ</a>
		</h1>
		<p><em>This post is partially related to my `previous blog post`_ about
Rewind_.</em></p>
<p>One of the questions that might hit you is <em>why would you ever write a
server in Python?</em>. Coming from a Java background, this is a question
I've been asking myself and Rewind gave me some time to review this.</p>
<p>Some of my reasons for choosing Python were:</p>
<ul class="simple">
<li>I was tired of slow development feedback from coding in Java.</li>
<li>I wanted to try out new creative ways to do testing. This involved
enforcing coding standards through tests and sometimes required some
introspection.</li>
<li>I wanted to try out full TDD. There were plenty of Python tools for
this job, including great <cite>mocking</cite> utilities.</li>
<li>I've been a big fan of Python for a long time. I wanted to see if it
stood the test also for heavy backend services.</li>
<li>Great support for <a class="reference external" href="http://www.zeromq.org">ZeroMQ</a>.</li>
</ul>
<p>Would Python stand the test for a rather performant server software? I
think so.  In Rewind I made the assumption that all events would be
persisted as one single event stream. Harddrives are great at
append-only storage and I was not that worried about concurrency. The
concurrency requirements lay in the fanout message pattern used to
notify event listeners of newly persisted events. ZeroMQ would deal with
that very well. This meant I could/would sleep well at night, not
worrying about the Python <a class="reference external" href="http://wiki.python.org/moin/GlobalInterpreterLock">GIL</a>.</p>
<div class="section" id="zeromq-patterns">
<h2>ZeroMQ Patterns</h2>
<p><a class="reference external" href="http://zguide.zeromq.org/page:all">The ZeroMQ Guide</a> is a great source of inspiration when it comes to
learning about how to build distributed applications using messaging
(and ZeroMQ). It not only teaches many of the options you have as a
developer, but also the fact that doing distributed systems the way
right is <em>hard</em>.</p>
<p>The guide became my inspiration. I love problem solving and I was
thinking hard about which parts could be made asynchronous in an event
sourced system, and which could not. <cite>Rinat Abdullin</cite>, a big CQRS
proponent, <a class="reference external" href="https://twitter.com/abdullin/status/291827247210459136">hinted</a> that most his code uses async communication. Still, I
decided to stick to synchronous writes to the event store.
Asynchronicity could be added to the write client if needed, I thought.</p>
<p>The other option would be to have asynchronous writes into the event
store. However, the write side of CQRS always need to make sure what
writes are persisted to correctly update its state. One option would be
to make it an event listener of the event store. My issue with that was
that bad writes also would have had to published as events. I felt that
would put to much requirements on future implementations. Maaybe I'm
wrong...</p>
</div>
<div class="section" id="storage-engines">
<h2>Storage engines</h2>
<p>Generally, all an event store really needs os a key value store. If fast
querying is not a requirement, simply an append-only file on disk will
do. Events are never removed anyway.</p>
<p>I spent a fair amount of time trying to find a decent key-value store
for Python, that did not have any external requirements. I wanted to
minimize the hazzle of installing/compiling 3rd party libraries to use
Rewind.</p>
<p>Finding a key-value for Python with those requirements turned out to be
harder than I thought.</p>
<p>TODO: Move this to above ZeroMQ Patterns?</p>
<div class="section" id="concurrency-go-and-where-we-are-today">
<h3>Concurrency, Go and where we are today</h3>
<p>After listening to <a class="reference external" href="http://beingtheworst.com">The Being the Worst</a> podcast for some time, it hit
me that an event store is not simply storing a single global event
stream. It stores.</p>
</div>
<div class="section" id="lessons-learned-and-the-future">
<h3>Lessons learned and the Future</h3>
<p>Rewind and its child project Gorewind has definitely spurred an
interest in me when it comes to DDD. I've spent some time reading about
the concepts...</p>
<p>TODO: Write.</p>
</div>
</div>


		<div id="article_meta">
							Category:
					<a href="http://jensrantil.github.io/category/misc.html">misc</a>
										<br />Tags:
									<a href="http://jensrantil.github.io/tag/cqrs.html">cqrs</a>
									<a href="http://jensrantil.github.io/tag/distributed-architecture.html">distributed-architecture</a>
									</div>
	</article>

	<footer>
		<a href="http://jensrantil.github.io/" class="button_accent">&larr;&nbsp;&nbsp;&nbsp;Back to blog</a>
	</footer>

		<div id="comments">
		<h2>Comments</h2>
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_identifier = "writing-a-server-in-python-using-zeromq.html";
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://jensrantil.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view <a href="http://disqus.com/?ref_noscript">comments</a>.</noscript>
	</div>
	
	</section>

	<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
			var pageTracker = _gat._getTracker("UA-40929103-1");
			pageTracker._trackPageview();
		} catch(err) {}</script>
</body>
</html>