<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" type="text/css" href="http://jensrantil.github.io/theme/css/style.css">
	<!--<link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">-->
	<!--<script src="/theme/js/less.js" type="text/javascript"></script>-->
	<link rel="stylesheet" type="text/css" href="http://jensrantil.github.io/theme/css/pygments.css">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>

	<link href="http://jensrantil.github.io/" type="application/atom+xml" rel="alternate" title="Jens Rantil's Hideout ATOM Feed" />
	
	
			<title>Jens Rantil's Hideout</title>
		<meta charset="utf-8" />
	</head>
<body>
	<section id="sidebar">
		<figure id="user_logo">
            <a href="http://jensrantil.github.io"><div class="logo">&nbsp;</div></a>
		</figure>

		<div class="user_meta">
            <h1 id="user"><a href="http://jensrantil.github.io" class="">Jens Rantil</a></h1>
			<h2></h2>
						<p class="bio">Swedish/English, fullstack software engineer (<a href="http://www.telavox.se" target="_blank">@Telavox</a>), <a href="http://www.lth.se/english/education/programmes/master_engineering/engineering_mathematics/">MSc in Engineering Mathematics</a>, traveller, nerd, juggler, guitarist, african drum player. Inspired Swede.</p>
						<ul>
																			<li><a href="http://jensrantil.github.io/pages/about-jens.html">About Jens</a></li>
																		<li><a href="http://www.twitter.com/JensRantil">Twitter</a></li>
									<li><a href="http://www.github.com/JensRantil">Github</a></li>
									<li><a href="http://www.linkedin.com/in/jensrantil">LinkedIn</a></li>
							</ul>
		</div>
		<footer>
			<address>
				Powered by <a href="http://pelican.notmyidea.org/">Pelican</a>,
		                theme by <a href="https://github.com/wting/pelican-svbtle">wting</a>.
			</address>
		</footer>
	</section>

	<section id="posts">
			<header>
		<h1>Jens Rantil's blog</h1>
		<h3>Posted Sun 19 May 2013</h3>
	</header>
	<article>
		<h1 id="title">
			<a href="http://jensrantil.github.io/cqrs-time-to-rewind.html" rel="bookmark"
				title="Permalink to CQRS - Time to Rewind">CQRS - Time to Rewind</a>
		</h1>
		<p>For the last year I've been thinking a lot about <a class="reference external" href="http://www.cqrsinfo.com">CQRS</a> [<a class="reference external" href="http://martinfowler.com/bliki/CQRS.html">1</a>], <a class="reference external" href="http://martinfowler.com/eaaDev/EventSourcing.html">Event
Sourcing</a> and distributed architecture using <a class="reference external" href="http://www.zeromq.org">ZeroMQ</a>. I first stumbled
across the concept of CQRS through the mailing list for a <a class="reference external" href="http://www.meetup.com/SoftPub/">nerd meetup
in Helsingborg</a>, Sweden. This led me to a lot of CQRS <a class="reference external" href="http://msdn.microsoft.com/en-us/library/jj554200.aspx">reading</a> and
<a class="reference external" href="http://cqrs.wordpress.com/video/">videos</a>, and with that the Event Sourcing data model.</p>
<p>To try out CQRS and Event Sourcing in practise, I started writing an
open source event store about a year ago. I named it <a class="reference external" href="http://www.github.com/JensRantil/rewind">Rewind</a>. This also
opened up for me to try some concepts that I had never tried before [2].</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>See below.</td></tr>
</tbody>
</table>
<div class="section" id="cqrs-and-event-sourcing">
<h2>CQRS and Event Sourcing</h2>
<p>But first, let's Rewind ;). Rewind's <a class="reference external" href="https://github.com/JensRantil/rewind/blob/develop/README.rst">README</a> does a fairly good job at an
elevator speech for <em>CQRS</em>:</p>
<blockquote>
<p>Have you ever been nervous of all those DBMSs schema changes when
you are deploying your applications? They are gonna take too long,
or break backward compatibility? Have you ever thought &quot;Crap, I wish
I had stored that information since earlier&quot;? Have you ever felt
your writing patterns and your reading patterns differ a lot, making
things harder to scale? Issues like these can be solved using <em>CQRS</em>
and <em>event sourcing</em>.</p>
<p><em>CQRS</em> (Command-Query Response Segregation) is an architectural pattern
that aims to solve these issues by splitting up your architectural
system into two parts:</p>
<ul class="simple">
<li>A <em>write side</em> that takes care of validating input and optimizes
for fast writes. The write side takes commands and outputs
corresponding events if the command validates correctly.</li>
<li>A <em>read side</em> that listens to incoming events from the write side.
The read side is optimized for fast reads and incrementally build
up state that can be queried fast.</li>
</ul>
<p>While not required, it is common to use messaging between the
write and read sides. This means that the system will be in an
inconsistent state from time to time. This is usually not an issue
and came be overcome in various ways.</p>
</blockquote>
<p>A couple of additional things to note about CQRS:</p>
<ul class="simple">
<li>As I see it, it is the architectural equivalent of <cite>the CQS design
pattern</cite>.</li>
<li>It is a pattern that decouples systems very well. This can have huge
implications when it comes to testability.</li>
<li>It's also worth noting that there are some similarities between Domain
Driven Design (<a class="reference external" href="http://www.wikipedia.org/Domain-driven_design">DDD</a>) and CQRS. Most vocabularies in DDD are used in
CQRS; ubiquous language, aggregates, aggregrate root, value objects,
bounded contexts etc.</li>
</ul>
<p>The README then states about <em>Event Sourcing</em>:</p>
<blockquote>
<p>A common pattern used together with CQRS is <em>event sourcing</em>. The
concept can be summarized as using state changes as primary
persistence, instead of the final state. The state changes are
called <em>events</em> and they are generated by the write side and
delivered to the read side.</p>
<p>The events are persisted in an event store that sits inbetween the
read and write side of things. It takes care of three things:</p>
<ul class="simple">
<li>persisting all events to disk.</li>
<li>being a hub/broker replicating all events from the write to the
read side of things.</li>
<li>allowind fast querying of events so that different parts of the
system can be synced back on track and new components can be
brought back in play.</li>
</ul>
</blockquote>
</div>
<div class="section" id="id3">
<h2>Rewind</h2>
<p>Question was, how would a CQRS/event sourced system behave in
production?  Could it scale out? Could writes be partitioned? What about
fault tolerance? I was tired of heavy database schema changes, I wanted
a nouvaeu way of testing and question some of the common practices.</p>
<p>Enter <a class="reference external" href="http://www.github.com/JensRantil/rewind">Rewind</a>; Rewind was my pet project for a <a class="reference external" href="https://github.com/JensRantil/rewind/graphs/commit-activity">major part of 2012</a>. It
was <em>a Python implementation of an event store that supported multiple
backends</em>. It really gave me an opportunity to try everything I wanted.</p>
<p>The development of Rewind halted at the beginning of 2013. From thereon,
I instead used the lessons I had learnt and rewrote Rewind's
functionality in <a class="reference external" href="http://www.golang.org">Go</a>. The project was named <a class="reference external" href="https://www.github.com/JensRantil/gorewind">GoRewind</a>.</p>
<p>Within the next couple of blog posts I plan to write about what I've
learnt from these two projects; design decisions, testability, ZeroMQ,
developing in Go among other things.</p>
</div>


		<div id="article_meta">
							Category:
					<a href="http://jensrantil.github.io/category/misc.html">misc</a>
										<br />Tags:
									<a href="http://jensrantil.github.io/tag/cqrs.html">cqrs</a>
									<a href="http://jensrantil.github.io/tag/distributed-architecture.html">distributed-architecture</a>
									</div>
	</article>

	<div class="donations">
		Dude, did you like this blog post? Feel free to
		drop me some bitcoins on
		<a href="bitcoin:1Q79HGDF3ZjfCwXLAW6e7gX4DeDu2GtZ7v">1Q79HGDF3ZjfCwXLAW6e7gX4DeDu2GtZ7v</a>.
	</div>

	<footer>
		<a href="http://jensrantil.github.io/" class="button_accent">&larr;&nbsp;&nbsp;&nbsp;Back to blog</a>
	</footer>

		<div id="comments">
		<h2>Comments</h2>
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_identifier = "cqrs-time-to-rewind.html";
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://jensrantil.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view <a href="http://disqus.com/?ref_noscript">comments</a>.</noscript>
	</div>
	
	</section>

	<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
			var pageTracker = _gat._getTracker("UA-40929103-1");
			pageTracker._trackPageview();
		} catch(err) {}</script>
</body>
</html>